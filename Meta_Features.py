#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Tue Sep 14 16:55:54 2021

@author: elliot
"""

def Meta_Features(flow): 
    tmp = []
    # Duration of the flow
    if ('time_start' in flow and 'time_end' in flow):
        tmp.append(round((flow['time_end']-flow['time_start']),2))
    else:
        tmp.append(0)
    # inbound bytes
    if 'bytes_in' in flow:
        tmp.append(flow['bytes_in']) 
    else:
        tmp.append(0)
    # outbound bytes
    if 'bytes_out' in flow:
        tmp.append(flow['bytes_out']) 
    else:
        tmp.append(0)
    # inbound packets
    if 'num_pkts_in' in flow:
        tmp.append(flow['num_pkts_in'])
    else: 
        tmp.append(0)
    # outbound packets
    if 'num_pkts_out' in flow:
        tmp.append(flow['num_pkts_out']) 
    else:
        tmp.append(0)
    # elapsed time of flow
    if flow['packets'] == []:
        tmp.append(0)
    else:
        time = 0
        for packet in flow['packets']:
            time += packet['ipt']
        tmp.append(time) 
    if 'byte_dist_mean' in flow:
        tmp.append(round(flow['byte_dist_mean'],2))
    else:
        tmp.append(0)
    if 'byte_dist_std' in flow:
        tmp.append(round(flow['byte_dist_std'],2)) 
    else:
        tmp.append(0)
    if 'entropy' in flow:
        tmp.append(round(flow['entropy'],2))
    else:
        tmp.append(0)
    if 'total_entropy' in flow:
        tmp.append(round(flow['total_entropy'],2))
    else:
        tmp.append(0)
#     if 'sa' in flow:
#         tmp.append(flow['sa']) 
#     else:
#         tmp.append(0)
#     if 'da' in flow:
#         tmp.append(flow['da']) 
#     else:
#         tmp.append(0)
    return tmp